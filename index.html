<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Name Combination Finder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial; padding: 10px; background: #f9f9f9; }
    input, button, select { font-size: 16px; margin: 6px 4px; padding: 6px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; display: block; max-height: 250px; overflow-y: auto; }
    th, td { border: 1px solid #ccc; padding: 8px; white-space: nowrap; }
    #results { margin-top: 15px; padding: 10px; background: #fff; border: 1px solid #ccc; }
    #loading { color: green; }
    #noMatch { color: red; }
  </style>
</head>
<body>

<h2>üî¢ Find Matching Name Combinations</h2>

<label>üéØ Target Value: <input type="number" id="target" value="100"></label>
<select id="comboLimit">
  <option value="4">Combinations of 1‚Äì4</option>
  <option value="5">Up to 5</option>
  <option value="6">Up to 6</option>
  <option value="8">Up to 8</option>
</select>
<button onclick="findCombinations()">üîç Find</button>

<div id="results"></div>

<h3>üìã Name Table</h3>
<table id="nameTable">
  <thead>
    <tr><th>Name</th><th>Value</th></tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<script>
  const items = [];

  function addRow(name, value) {
    items.push({ name, value: parseInt(value) });
  }

  function updateTable() {
    const body = document.getElementById("tableBody");
    body.innerHTML = '';
    for (const { name, value } of items) {
      const row = document.createElement("tr");
      row.innerHTML = `<td>${name}</td><td>${value}</td>`;
      body.appendChild(row);
    }
  }

  function findCombinations() {
    const target = parseInt(document.getElementById("target").value);
    const maxCombo = parseInt(document.getElementById("comboLimit").value);
    const resultDiv = document.getElementById("results");
    resultDiv.innerHTML = "<span id='loading'>‚è≥ Searching...</span>";
    setTimeout(() => {
      const matches = [];
      let closest = null;
      let minDiff = Infinity;

      function search(start, combo, sum) {
        if (combo.length > maxCombo || sum > target) return;
        if (sum === target && combo.length >= 1) {
          matches.push([...combo]);
          return;
        }
        for (let i = start; i < items.length; i++) {
          const item = items[i];
          const newSum = sum + item.value;
          search(i + 1, [...combo, item], newSum);
          const diff = Math.abs(newSum - target);
          if (diff < minDiff) {
            minDiff = diff;
            closest = [...combo, item];
          }
        }
      }

      search(0, [], 0);

      if (matches.length > 0) {
        resultDiv.innerHTML = `<h4>‚úÖ Found ${matches.length} combinations:</h4><ul>` +
          matches.map(combo =>
            `<li>${combo.map(x => `${x.name} (${x.value})`).join(' + ')} = ${combo.reduce((a, b) => a + b.value, 0)}</li>`
          ).join('') + `</ul>`;
      } else if (closest) {
        const sum = closest.reduce((a, b) => a + b.value, 0);
        resultDiv.innerHTML = `<h4>‚ùå No exact match. Closest combination:</h4>
          <p>${closest.map(x => `${x.name} (${x.value})`).join(' + ')} = ${sum}<br>
          üéØ Off by: ${sum - target}</p>`;
      } else {
        resultDiv.innerHTML = `<p id='noMatch'>‚ùå No combinations found.</p>`;
      }
    }, 100);
  }

  // Load name-value pairs from data.txt
  fetch('data.txt')
    .then(res => res.text())
    .then(text => {
      text.split('\n').forEach(line => {
        const [name, value] = line.trim().split(',');
        if (name && !isNaN(value)) {
          addRow(name, value);
        }
      });
      updateTable();
    })
    .catch(err => {
      document.getElementById('results').innerHTML = '‚ùå Failed to load data.txt: ' + err.message;
    });
</script>

</body>
</html>
